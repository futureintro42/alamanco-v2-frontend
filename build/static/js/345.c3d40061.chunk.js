"use strict";(self.webpackChunkfront_end=self.webpackChunkfront_end||[]).push([[345],{8345:(e,t,r)=>{r.r(t),r.d(t,{default:()=>y});var a=r(5043),n=r(4858),i=r(8403),s=r(6410),c=r(1881),u=r(3216),o=r(2671),l=r(2356),f=r(903),d=r(9351),p=r(7343),m=r(2010),g=r(579);const y=()=>{const e=(0,u.Zp)(),{id:t}=(0,u.g)(),[r,y]=a.useState(!0),[_,b]=a.useState("error"),[h,v]=a.useState(""),[S,x]=a.useState(""),[C,j]=a.useState(""),[k,P]=a.useState(!1),[q,E]=a.useState(""),[F,M]=a.useState(""),[O,{loading:z,error:B,data:H}]=(0,s._)(m.nj),[Q,{loading:R,error:w,data:A}]=(0,c.n)(d.tz),{register:D,handleSubmit:T,setError:I,setValue:N,resetField:U,formState:{errors:V}}=(0,n.mN)({resolver:(0,i.t)(f.uk)});a.useEffect((()=>{O({variables:{input:{_id:t}}})}),[t,O]),a.useEffect((()=>{if(!z&&!B&&H){const t=H.findCardById;if(t.response){const{name:e,iqama_number:r,issue_date:a,expiry_date:n,certified_as:i,profile_pic:s,company:c,examiner:u}=t.response;if(N("name",e),N("iqama_number",r),N("certified_as",i),N("company",c),N("examiner",u),E(a),M(n),j(s),s){x("".concat("https://alamanco.com/isce","/images/profile/").concat(s))}y(!1)}else e("/cards")}}),[z,B,H,e,y,N]);a.useEffect((()=>{if(!R&&!w&&A){const t=A.updateCard;b(t.severity),v(t.message),(0,p.ft)(t.error,I),P(!1),!t.error&&t.severity.includes("success")&&e("/cards")}}),[R,w,A,b,v,I,e]);return r?(0,g.jsx)(o.A,{}):(0,g.jsx)(l.A,{handleSubmit:T,onSubmitHandler:(e,r)=>{r.preventDefault();const{name:a,iqama_number:n,certified_as:i,company:s,examiner:c}=e;let u=e.issue_date.split("/");u="".concat(u[2],"-").concat(u[1],"-").concat(u[0]);let o=e.expiry_date.split("/");o="".concat(o[2],"-").concat(o[1],"-").concat(o[0]),Q({variables:{input:{name:a,iqama_number:n,certified_as:i,issue_date:u,expiry_date:o,company:s,examiner:c,_id:t,profile_pic:C||""}}})},register:D,errors:V,severity:_,message:h,isSubmitted:k,title:"Edit Card",submitBtnTxt:"Submit",issue_date:q,expiry_date:F,onChangeFileHandler:e=>{const{files:t}=e.target;if(t&&t[0]){const{name:r,size:a}=t[0],n=a/1024/1024;/(\.jpg|\.jpeg|\.png|\.gif)$/i.exec(r)?n>5?I("profile_pic",{type:"manual",message:"File size exceeds 5 MiB"}):(0,p.Hm)(e.target).then((e=>{x(e),j(e),U("profile_pic")})).catch((e=>console.error(e))):I("profile_pic",{type:"manual",message:"Please you can upload file having extensions .jpeg/.jpg/.png/.gif only."})}},imageSrc:S})}},6410:(e,t,r)=>{r.d(t,{_:()=>o});var a=r(6326),n=r(48),i=r(2277),s=r(8250),c=r(5190),u=["refetch","reobserve","fetchMore","updateQuery","startPolling","subscribeToMore"];function o(e,t){var r,o=n.useRef(),l=n.useRef(),f=n.useRef(),d=(0,i.l)(t,o.current||{}),p=null!==(r=null===d||void 0===d?void 0:d.query)&&void 0!==r?r:e;l.current=t,f.current=p;var m=(0,s.k)((0,c.m)(t&&t.client),p),g=m.useQuery((0,a.Cl)((0,a.Cl)({},d),{skip:!o.current})),y=g.observable.options.initialFetchPolicy||m.getDefaultFetchPolicy(),_=Object.assign(g,{called:!!o.current}),b=n.useMemo((function(){for(var e={},t=function(t){var r=_[t];e[t]=function(){return o.current||(o.current=Object.create(null),m.forceUpdateState()),r.apply(this,arguments)}},r=0,a=u;r<a.length;r++){t(a[r])}return e}),[]);Object.assign(_,b);var h=n.useCallback((function(e){o.current=e?(0,a.Cl)((0,a.Cl)({},e),{fetchPolicy:e.fetchPolicy||y}):{fetchPolicy:y};var t=(0,i.l)(l.current,(0,a.Cl)({query:f.current},o.current)),r=m.executeQuery((0,a.Cl)((0,a.Cl)({},t),{skip:!1})).then((function(e){return Object.assign(e,b)}));return r.catch((function(){})),r}),[]);return[h,_]}}}]);
//# sourceMappingURL=345.c3d40061.chunk.js.map